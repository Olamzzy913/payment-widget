(function(i,n){typeof exports=="object"&&typeof module<"u"?module.exports=n():typeof define=="function"&&define.amd?define(n):(i=typeof globalThis<"u"?globalThis:i||self,i.PaymentWidgetSDK=n())})(this,function(){"use strict";class i{constructor(e){this.config=this.validateConfig(e),this.iframe=null,this.isInitialized=!1}validateConfig(e){if(!e.apiKey)throw new Error("API key is required");return{apiKey:e.apiKey,amount:e.amount||0,currency:e.currency||"USD",environment:e.environment||"sandbox",onSuccess:e.onSuccess||(()=>{}),onError:e.onError||(()=>{}),onLoad:e.onLoad||(()=>{})}}getIframeUrl(){const e={development:"http://localhost:3001",sandbox:"https://your-vercel-app.vercel.app",production:"https://your-vercel-app.vercel.app"};return`${e[this.config.environment]||e.sandbox}/index.html`}init(e){if(this.isInitialized)throw new Error("Widget already initialized");if(!e||!(e instanceof HTMLElement))throw new Error("Valid container element is required");return new Promise((t,r)=>{try{this.iframe=document.createElement("iframe"),this.iframe.src=this.getIframeUrl(),this.iframe.style.cssText=`
          border: none;
          width: 100%;
          min-width: 380px;
          height: 600px;
          border-radius: 12px;
          box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        `,this.iframe.onload=()=>{this.isInitialized=!0,this.config.onLoad(),t()},this.iframe.onerror=()=>{r(new Error("Failed to load payment widget"))},e.appendChild(this.iframe),this.setupMessageHandling()}catch(s){r(s)}})}setupMessageHandling(){window.addEventListener("message",this.handleMessage.bind(this))}handleMessage(e){if(!this.isValidOrigin(e.origin))return;const{type:t,data:r}=e.data;switch(t){case"PAYMENT_SUCCESS":this.config.onSuccess(r);break;case"PAYMENT_ERROR":this.config.onError(r);break;case"WIDGET_READY":console.log("Payment widget ready");break}}isValidOrigin(e){return["http://localhost:3001","https://your-widget-sandbox.netlify.app","https://your-widget-prod.netlify.app"].includes(e)}destroy(){this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.isInitialized=!1,this.iframe=null,window.removeEventListener("message",this.handleMessage)}}return typeof window<"u"&&(window.PaymentWidgetSDK=i),i});
